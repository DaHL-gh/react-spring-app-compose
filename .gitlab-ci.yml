image: docker:20.10.16-dind-alpine3.16

services: 
  - docker:20.10.16-dind-alpine3.16

stages:
  - build

react-build:
  stage: build
  variables:
    DOCKER_TAG: "dahl8dh/hobbie-react-frontend:v1"
    DOCKERFILE_PATH: "./react-frontend/"
  script:
    - docker build -t "$DOCKER_TAG" "$DOCKERFILE_PATH"
    - docker push "$DOCKER_TAG"

spring-build:
  stage: build
  variables:
    DOCKER_TAG: "dahl8dh/hobbie-spring-backend:v1"
    DOCKERFILE_PATH: "./spring-backend/"
  script:
    - docker build -t "$DOCKER_TAG" "$DOCKERFILE_PATH"
    - docker push "$DOCKER_TAG"

